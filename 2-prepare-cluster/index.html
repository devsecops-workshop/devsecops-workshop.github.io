<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.69.0" />
    <meta name="description" content="A DevSecOps Workshop Day using openShift and ACS">
<meta name="author" content="GÃ¶tz, Daniel">

    <link rel="icon" href="https://devsecops-workshop.github.io/images/favicon.png" type="image/png">

    <title>Prepare Cluster :: DevSecOps Workshop 2021</title>

    
    <link href="https://devsecops-workshop.github.io/css/nucleus.css?1634899816" rel="stylesheet">
    <link href="https://devsecops-workshop.github.io/css/fontawesome-all.min.css?1634899816" rel="stylesheet">
    <link href="https://devsecops-workshop.github.io/css/hybrid.css?1634899816" rel="stylesheet">
    <link href="https://devsecops-workshop.github.io/css/featherlight.min.css?1634899816" rel="stylesheet">
    <link href="https://devsecops-workshop.github.io/css/perfect-scrollbar.min.css?1634899816" rel="stylesheet">
    <link href="https://devsecops-workshop.github.io/css/auto-complete.css?1634899816" rel="stylesheet">
    <link href="https://devsecops-workshop.github.io/css/atom-one-dark-reasonable.css?1634899816" rel="stylesheet">
    <link href="https://devsecops-workshop.github.io/css/theme.css?1634899816" rel="stylesheet">
    <link href="https://devsecops-workshop.github.io/css/tabs.css?1634899816" rel="stylesheet">
    <link href="https://devsecops-workshop.github.io/css/hugo-theme.css?1634899816" rel="stylesheet">
    
    <link href="https://devsecops-workshop.github.io/css/theme-red.css?1634899816" rel="stylesheet">
    
    

    <script src="https://devsecops-workshop.github.io/js/jquery-3.3.1.min.js?1634899816"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
  </head>
  <body class="" data-url="/2-prepare-cluster/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://devsecops-workshop.github.io/">
    <img src="https://devsecops-workshop.github.io/images/acs-logo.png">
  </a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="https://devsecops-workshop.github.io/js/lunr.min.js?1634899816"></script>
<script type="text/javascript" src="https://devsecops-workshop.github.io/js/auto-complete.js?1634899816"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/devsecops-workshop.github.io\/";
    
</script>
<script type="text/javascript" src="https://devsecops-workshop.github.io/js/search.js?1634899816"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='https://devsecops-workshop.github.io/'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/1-intro/" title="The DevSecOps Workshop" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/1-intro/">
          The DevSecOps Workshop
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2-prepare-cluster/" title="Prepare Cluster" class="dd-item
        
        active
        
        ">
      <a href="https://devsecops-workshop.github.io/2-prepare-cluster/">
          Prepare Cluster
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/3-inner-loop/" title="Inner Loop" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/3-inner-loop/">
          Inner Loop
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/4-outer-loop/" title="Outer Loop" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/4-outer-loop/">
          Outer Loop
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/5-gitops/" title="Configure GitOps" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/5-gitops/">
          Configure GitOps
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/10-rhacs-setup/" title="Install and Configure ACS" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/10-rhacs-setup/">
          Install and Configure ACS
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/11-rhacs-warmup/" title="Getting to know ACS" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/11-rhacs-warmup/">
          Getting to know ACS
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/12-create-policy/" title="Create a Custom Security Policy" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/12-create-policy/">
          Create a Custom Security Policy
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/13-rhacs-pipeline/" title="Integrating ACS into the Pipeline" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/13-rhacs-pipeline/">
          Integrating ACS into the Pipeline
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/14-runtime-security/" title="Securing Runtime Events" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/14-runtime-security/">
          Securing Runtime Events
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/100-playground/" title="Playground" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/100-playground/">
          Playground
          
      </a>
      
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://devsecops-workshop.github.io/"><i class='fas fa-home'></i> Homepage</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            <a href='https://devsecops-workshop.github.io/'></a> > Prepare Cluster
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#cluster-preparation">Cluster Preparation</a></li>
    <li><a href="#install-and-prepare-gitea">Install and Prepare Gitea</a></li>
    <li><a href="#install-and-prepare-codeready-workspaces-crw">Install and Prepare CodeReady Workspaces (CRW)</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Prepare Cluster
            </h1>
          

        



	<h2 id="cluster-preparation">Cluster Preparation</h2>
<p>Before you start you have to install a number of components you&rsquo;ll use during the workshop. The first two are <code>Gitea</code> for providing Git services in your cluster and <code>CodeReady Workspaces</code> as development environment. But fear not, both are managed by an operator.</p>
<h2 id="install-and-prepare-gitea">Install and Prepare Gitea</h2>
<p>We&rsquo;ll need Git repository srvices, so let&rsquo;s just install trusted <code>Gitea</code> using an operator:</p>

<div class="notices tip" ><p>This is a good example of how you can integrate an operator into your catalog that is not part of the default OperatorHub already.</p>
</div>

<ul>
<li>Log in the <code>oc</code> command to your OpenShift cluster (the easiest way is to use the <strong>Copy login command</strong> link in the OCP web UI).</li>
<li>Now using <code>oc</code> add the Gitea Operator to your OperatorHub</li>
</ul>
<pre><code>oc apply -f https://raw.githubusercontent.com/redhat-gpte-devopsautomation/gitea-operator/master/catalog_source.yaml
</code></pre><ul>
<li>Go to OperatorHub and search for <code>Gitea</code></li>
<li>Install the <code>Gitea Operator</code> with default settings</li>
<li>Create a new project <code>git</code></li>
<li>Go to <strong>Installed Operators -&gt; Gitea Operator</strong> and click <strong>Create instance</strong> in the new project.</li>
<li>On the <strong>Create Gitea</strong> page switch to the YAML view and make sure the following <code>spec</code> values exist:</li>
</ul>
<pre><code>spec:
  giteaSsl: true
  giteaAdminUser: gitea
  giteaAdminPassword: &quot;gitea&quot;
  giteaAdminEmail: opentlc-mgr@redhat.com
</code></pre><ul>
<li>Click <strong>Create</strong></li>
</ul>
<p>After creation has finished:</p>
<ul>
<li>Look up and access the <code>repository</code> route, this will take you to the Gitea web UI</li>
<li>Login to Gitea with user <code>gitea</code> and password <code>gitea</code></li>
<li>Clone the example repo:
<ul>
<li>Click the <strong>+</strong> dropdown and choose <strong>New Migration</strong></li>
<li>As type choose <strong>Git</strong></li>
<li><strong>URL</strong>: <a href="https://github.com/devsecops-workshop/quarkus-build-options.git">https://github.com/devsecops-workshop/quarkus-build-options.git</a></li>
<li>Click <strong>Migrate Repository</strong></li>
</ul>
</li>
</ul>
<p>In the cloned repository you&rsquo;ll find a <code>devfile.yml</code> for use with CodeReady Workspaces (CRW). You have to edit the file to point to your own repository:</p>
<ul>
<li>Copy the clone URL of your repo.</li>
<li>Edit the <code>devfile.yml</code> by clicking it and selecting the <strong>Edit File</strong> pencil icon.
<ul>
<li>In the file change <strong>location:</strong> to the clone URL you just copied.</li>
<li>Commit changes</li>
</ul>
</li>
</ul>
<h2 id="install-and-prepare-codeready-workspaces-crw">Install and Prepare CodeReady Workspaces (CRW)</h2>
<ul>
<li>Install the CRW Operator from OperatorHub (not the Tech Preview one!) using default settings.</li>
<li>Go to <strong>Installed Operators -&gt; CodeReady Workspaces</strong> and create a new instance (CodeReady Workspaces instance Specification) using the default settings.</li>
<li>Wait until deployment has finished.</li>
</ul>
<p>As you&rsquo;ll start your CRW workspace using the devfile mechanism, you have to compose the URL from the codeready route and the devfile location.</p>
<ul>
<li>First look up the <code>codeready</code> route and the full URL to access the <code>devfile.yml</code> in Gitea by using the &ldquo;raw&rdquo; format button.</li>
<li>Now use both components to build an URL like below:</li>
</ul>
<pre><code>https://&lt;codeready-openshift-route&gt;/f?url=&lt;full URL to devfile.yml&gt;
</code></pre><p>For example it could look like this:</p>
<pre><code>https://&lt;codeready-openshift-workspaces.apps.cluster-mqpmq.mqpmq.sandbox283.opentlc.com/f?url=https://repository-git.apps.cluster-mqpmq.mqpmq.sandbox283.opentlc.com/gitea/quarkus-build-options/raw/branch/master/devfile.yml
</code></pre><ul>
<li>Now use this URL to launch your CRW Workspace in your Browser
<ul>
<li>Log in as User opentlc-mgr</li>
<li>Apply permissions</li>
<li>In the next form add an email address, it will be added to Keycloak</li>
</ul>
</li>
</ul>
<p>Have a good look around the UI, it should look familiar if you have ever worked with VSCode and the like. To prepare the Workspace for developing with OpenShift, ru the following steps:</p>
<ul>
<li>In the CRW shortcuts menu to the right (&ldquo;cube icon&rdquo;)
<ul>
<li>Run <strong>install oc</strong></li>
<li>Run <strong>install odo</strong></li>
</ul>
</li>
<li>Close the tabs the installation opened.</li>
</ul>





<footer class=" footline" >
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="https://devsecops-workshop.github.io/1-intro/" title="The DevSecOps Workshop"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="https://devsecops-workshop.github.io/3-inner-loop/" title="Inner Loop" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="https://devsecops-workshop.github.io/js/clipboard.min.js?1634899816"></script>
    <script src="https://devsecops-workshop.github.io/js/perfect-scrollbar.min.js?1634899816"></script>
    <script src="https://devsecops-workshop.github.io/js/perfect-scrollbar.jquery.min.js?1634899816"></script>
    <script src="https://devsecops-workshop.github.io/js/jquery.sticky.js?1634899816"></script>
    <script src="https://devsecops-workshop.github.io/js/featherlight.min.js?1634899816"></script>
    <script src="https://devsecops-workshop.github.io/js/highlight.pack.js?1634899816"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="https://devsecops-workshop.github.io/js/modernizr.custom-3.6.0.js?1634899816"></script>
    <script src="https://devsecops-workshop.github.io/js/learn.js?1634899816"></script>
    <script src="https://devsecops-workshop.github.io/js/hugo-learn.js?1634899816"></script>
    
        
            <script src="https://devsecops-workshop.github.io/mermaid/mermaid.js?1634899816"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>
