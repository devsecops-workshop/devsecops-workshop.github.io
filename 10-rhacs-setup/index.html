<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.69.0" />
    <meta name="description" content="A DevSecOps Workshop Day using openShift and ACS">
<meta name="author" content="GÃ¶tz, Daniel">

    <link rel="icon" href="https://devsecops-workshop.github.io/images/favicon.png" type="image/png">

    <title>Install and Configure ACS :: DevSecOps Workshop</title>

    
    <link href="https://devsecops-workshop.github.io/css/nucleus.css?1712675336" rel="stylesheet">
    <link href="https://devsecops-workshop.github.io/css/fontawesome-all.min.css?1712675336" rel="stylesheet">
    <link href="https://devsecops-workshop.github.io/css/hybrid.css?1712675336" rel="stylesheet">
    <link href="https://devsecops-workshop.github.io/css/featherlight.min.css?1712675336" rel="stylesheet">
    <link href="https://devsecops-workshop.github.io/css/perfect-scrollbar.min.css?1712675336" rel="stylesheet">
    <link href="https://devsecops-workshop.github.io/css/auto-complete.css?1712675336" rel="stylesheet">
    <link href="https://devsecops-workshop.github.io/css/atom-one-dark-reasonable.css?1712675336" rel="stylesheet">
    <link href="https://devsecops-workshop.github.io/css/theme.css?1712675336" rel="stylesheet">
    <link href="https://devsecops-workshop.github.io/css/tabs.css?1712675336" rel="stylesheet">
    <link href="https://devsecops-workshop.github.io/css/hugo-theme.css?1712675336" rel="stylesheet">
    
    <link href="https://devsecops-workshop.github.io/css/theme-red.css?1712675336" rel="stylesheet">
    
    

    <script src="https://devsecops-workshop.github.io/js/jquery-3.3.1.min.js?1712675336"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
<script src="https://devsecops-workshop.github.io/js/custom.js"></script>
  </head>
  <body class="" data-url="/10-rhacs-setup/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://devsecops-workshop.github.io/">
    <img src="https://devsecops-workshop.github.io/images/acs-logo.png">
  </a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="https://devsecops-workshop.github.io/js/lunr.min.js?1712675336"></script>
<script type="text/javascript" src="https://devsecops-workshop.github.io/js/auto-complete.js?1712675336"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/devsecops-workshop.github.io\/";
    
</script>
<script type="text/javascript" src="https://devsecops-workshop.github.io/js/search.js?1712675336"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='https://devsecops-workshop.github.io/'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/1-intro/" title="The DevSecOps Workshop" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/1-intro/">
          The DevSecOps Workshop
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2-install-prerequisites/" title="Install Prerequisites" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/2-install-prerequisites/">
          Install Prerequisites
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2.1-prepare-cluster/" title="Prepare Cluster" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/2.1-prepare-cluster/">
          Prepare Cluster
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/3-inner-loop/" title="Inner Loop" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/3-inner-loop/">
          Inner Loop
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/4-outer-loop/" title="Outer Loop" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/4-outer-loop/">
          Outer Loop
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/5-gitops/" title="Configure GitOps" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/5-gitops/">
          Configure GitOps
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/10-rhacs-setup/" title="Install and Configure ACS" class="dd-item
        
        active
        
        ">
      <a href="https://devsecops-workshop.github.io/10-rhacs-setup/">
          Install and Configure ACS
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/11-rhacs-warmup/" title="Getting to know ACS" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/11-rhacs-warmup/">
          Getting to know ACS
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/12-create-policy/" title="Create a Custom Security Policy" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/12-create-policy/">
          Create a Custom Security Policy
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/13-rhacs-pipeline/" title="Integrating ACS into the Pipeline" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/13-rhacs-pipeline/">
          Integrating ACS into the Pipeline
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/15-runtime-security/" title="Securing Runtime Events" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/15-runtime-security/">
          Securing Runtime Events
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/16-acm/" title="Advanced Cluster Management" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/16-acm/">
          Advanced Cluster Management
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/20-appendix/" title="Appendix" class="dd-item
        
        
        
        ">
      <a href="https://devsecops-workshop.github.io/20-appendix/">
          Appendix
          
      </a>
      
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://devsecops-workshop.github.io/"><i class='fas fa-home'></i> Homepage</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            <a href='https://devsecops-workshop.github.io/'></a> > Install and Configure ACS
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#install-rhacs">Install RHACS</a>
      <ul>
        <li><a href="#rhcas-operator">RHCAS Operator</a></li>
        <li><a href="#installing-the-main-component-central">Installing the main component <strong>Central</strong></a></li>
        <li><a href="#prepare-to-add-secured-clusters">Prepare to add Secured Clusters</a></li>
        <li><a href="#prepare-the-secured-cluster">Prepare the Secured Cluster</a></li>
        <li><a href="#add-the-cluster-as-securedcluster-to-acs-central">Add the Cluster as <strong>SecuredCluster</strong> to <strong>ACS Central</strong></a></li>
      </ul>
    </li>
    <li><a href="#configure-quay-integrations-in-acs">Configure Quay Integrations in ACS</a>
      <ul>
        <li><a href="#create-an-integration-to-scan-the-quay-registry">Create an integration to scan the Quay registry</a></li>
      </ul>
    </li>
    <li><a href="#architecture-recap">Architecture recap</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Install and Configure ACS
            </h1>
          

        



	<p>During the workshop you went through the OpenShift developer experience starting from software development using Quarkus and <strong>odo</strong>, moving on to automating build and deployment using Tekton pipelines and finally using GitOps for production deployments.</p>
<p>Now it&rsquo;s time to add another extremely important piece to the setup: enhancing application security in a containerized world. Using <strong>Red Hat Advanced Cluster Security for Kubernetes</strong>, of course!</p>
<h2 id="install-rhacs">Install RHACS</h2>
<h3 id="rhcas-operator">RHCAS Operator</h3>
<p>Install the <strong>Advanced Cluster Security for Kubernetes</strong> operator from the OperatorHub:</p>
<ul>
<li>Switch <strong>Update approval</strong> to <code>Manual</code></li>
<li>Apart from this use the default settings</li>
<li>Approve the installation when asked</li>
</ul>

<div class="notices info" ><p>Red Hat recommends installing the Red Hat Advanced Cluster Security for Kubernetes Operator in the <strong>rhacs-operator</strong> namespace. This will happen by default..</p>
</div>

<h3 id="installing-the-main-component-central">Installing the main component <strong>Central</strong></h3>

<div class="notices info" ><p>You must install the ACS Central instance in its own project and not in the <strong>rhacs-operator</strong> and <strong>openshift-operator</strong> projects, or in any project in which you have installed the ACS Operator!</p>
</div>

<ul>
<li>Navigate to <strong>Operators â Installed Operators</strong></li>
<li>Select the ACS operator</li>
<li>You should now be in the <strong>rhacs-operator</strong> project the Operator created, create a new OpenShift <strong>Project</strong> for the <strong>Central</strong> instance:
<ul>
<li>Select <strong>Project: rhacs-operator â Create project</strong></li>
<li>Create a new project called <strong>stackrox</strong> (Red Hat recommends using <strong>stackrox</strong> as the project name.)</li>
</ul>
</li>
<li>In the Operator view under <strong>Provided APIs</strong> on the tile <strong>Central</strong> click <strong>Create Instance</strong></li>
<li>Switch to the YAMl View.</li>
<li>Replace the YAML content with the following:</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#66d9ef">apiVersion</span>: platform.stackrox.io/v1alpha1
<span style="color:#66d9ef">kind</span>: Central
<span style="color:#66d9ef">metadata</span>:
  <span style="color:#66d9ef">name</span>: stackrox-central-services
  <span style="color:#66d9ef">namespace</span>: stackrox
<span style="color:#66d9ef">spec</span>:
  <span style="color:#66d9ef">monitoring</span>:
    <span style="color:#66d9ef">openshift</span>:
      <span style="color:#66d9ef">enabled</span>: <span style="color:#66d9ef">true</span>
  <span style="color:#66d9ef">central</span>:
    <span style="color:#66d9ef">notifierSecretsEncryption</span>:
      <span style="color:#66d9ef">enabled</span>: <span style="color:#66d9ef">false</span>
    <span style="color:#66d9ef">exposure</span>:
      <span style="color:#66d9ef">loadBalancer</span>:
        <span style="color:#66d9ef">enabled</span>: <span style="color:#66d9ef">false</span>
        <span style="color:#66d9ef">port</span>: <span style="color:#ae81ff">443</span>
      <span style="color:#66d9ef">nodePort</span>:
        <span style="color:#66d9ef">enabled</span>: <span style="color:#66d9ef">false</span>
      <span style="color:#66d9ef">route</span>:
        <span style="color:#66d9ef">enabled</span>: <span style="color:#66d9ef">true</span>
    <span style="color:#66d9ef">telemetry</span>:
      <span style="color:#66d9ef">enabled</span>: <span style="color:#66d9ef">true</span>
    <span style="color:#66d9ef">db</span>:
      <span style="color:#66d9ef">isEnabled</span>: Default
      <span style="color:#66d9ef">persistence</span>:
        <span style="color:#66d9ef">persistentVolumeClaim</span>:
          <span style="color:#66d9ef">claimName</span>: central-db
      <span style="color:#66d9ef">resources</span>:
        <span style="color:#66d9ef">limits</span>:
          <span style="color:#66d9ef">cpu</span>: <span style="color:#ae81ff">2</span>
          <span style="color:#66d9ef">memory</span>: 6Gi
        <span style="color:#66d9ef">requests</span>:
          <span style="color:#66d9ef">cpu</span>: 500m
          <span style="color:#66d9ef">memory</span>: 1Gi    
    <span style="color:#66d9ef">persistence</span>:
      <span style="color:#66d9ef">persistentVolumeClaim</span>:
        <span style="color:#66d9ef">claimName</span>: stackrox-db
  <span style="color:#66d9ef">egress</span>:
    <span style="color:#66d9ef">connectivityPolicy</span>: Online
  <span style="color:#66d9ef">scannerV4</span>:
    <span style="color:#66d9ef">db</span>:
      <span style="color:#66d9ef">persistence</span>:
        <span style="color:#66d9ef">persistentVolumeClaim</span>:
          <span style="color:#66d9ef">claimName</span>: scanner-v4-db
    <span style="color:#66d9ef">indexer</span>:
      <span style="color:#66d9ef">scaling</span>:
        <span style="color:#66d9ef">autoScaling</span>: Disabled
        <span style="color:#66d9ef">maxReplicas</span>: <span style="color:#ae81ff">2</span>
        <span style="color:#66d9ef">minReplicas</span>: <span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">replicas</span>: <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">matcher</span>:
      <span style="color:#66d9ef">scaling</span>:
        <span style="color:#66d9ef">autoScaling</span>: Disabled
        <span style="color:#66d9ef">maxReplicas</span>: <span style="color:#ae81ff">2</span>
        <span style="color:#66d9ef">minReplicas</span>: <span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">replicas</span>: <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">scannerComponent</span>: Default
  <span style="color:#66d9ef">scanner</span>:
    <span style="color:#66d9ef">analyzer</span>:
      <span style="color:#66d9ef">scaling</span>:
        <span style="color:#66d9ef">autoScaling</span>: Disabled
        <span style="color:#66d9ef">maxReplicas</span>: <span style="color:#ae81ff">2</span>
        <span style="color:#66d9ef">minReplicas</span>: <span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">replicas</span>: <span style="color:#ae81ff">1</span>

</code></pre></div><ul>
<li>Click <strong>Create</strong></li>
</ul>
<p>After the deployment has finished (<strong>Status</strong> <code>Conditions: Deployed, Initialized</code> in the Operator view on the <strong>Central</strong> tab), it can take some time until the application is completely up and running. One easy way to check the state, is to switch to the <strong>Developer</strong> console view on the upper left. Then make sure you are in the <strong>stackrox</strong> project and open the <strong>Topology</strong> map. You&rsquo;ll see the three deployments of the <strong>Central</strong> instance:</p>
<ul>
<li><strong>scanner</strong></li>
<li><strong>scanner-db</strong></li>
<li><strong>central</strong></li>
<li><strong>central-db</strong></li>
</ul>
<p>Wait until all Pods have been scaled up properly.</p>
<p><strong>Verify the Installation</strong></p>
<p>Switch to the <strong>Administrator</strong> console view again. Now to check the installation of your <strong>Central</strong> instance, access the <strong>ACS Portal</strong>:</p>
<ul>
<li>Look up the <strong>central-htpasswd</strong> secret that was created to get the password</li>
</ul>

<div class="notices info" ><p>If you access the details of your <strong>Central</strong> instance in the Operator page you&rsquo;ll find the complete commandline using <code>oc</code> to retrieve the password from the secret under <code>Admin Credentials Info</code>. Just sayin&hellip; ;)</p>
</div>

<ul>
<li>Look up and access the route <strong>central</strong> which was also generated automatically.</li>
</ul>
<p>This will get you to the <strong>ACS Portal</strong>, accept the self-signed certificate and login as user <strong>admin</strong> with the password from the secret.</p>
<p>Now you have a <strong>Central</strong> instance that provides the following services in an
RHACS setup:</p>
<ul>
<li>
<p>The application management interface and services. It handles data persistence, API interactions, and user interface access. You can use the same <strong>Central</strong> instance to <strong>secure multiple</strong> OpenShift or Kubernetes clusters.</p>
</li>
<li>
<p>Scanner, which is a vulnerability scanner for scanning container images. It analyzes all image layers for known vulnerabilities from the Common Vulnerabilities and Exposures (CVEs) list. Scanner also identifies vulnerabilities in packages installed by package managers and in dependencies for multiple programming languages.</p>
</li>
</ul>
<p>To actually do and see anything you need to add a <strong>SecuredCluster</strong> (be it the same or another OpenShift cluster). For effect go to the <strong>ACS Portal</strong>, the Dashboard should by pretty empty, click on either of the <strong>Compliance</strong> link in the menu to the left, lots of zero&rsquo;s and empty panels, too.</p>
<p>This is because you don&rsquo;t have a monitored and secured OpenShift cluster yet.</p>
<h3 id="prepare-to-add-secured-clusters">Prepare to add Secured Clusters</h3>
<p>Now we&rsquo;ll add your OpenShift cluster as <strong>Secured Cluster</strong> to ACS.</p>
<p>First, you have to generate an init bundle which contains certificates and is used to authenticate a <strong>SecuredCluster</strong> to the <strong>Central</strong> instance, regardless if it&rsquo;s the same cluster as the Central instance or a remote/other cluster.</p>
<p>We are using the API to create the init bundle in this workshop, because if we use the Web Terminal we can&rsquo;t upload and downloaded file to it. For the steps to create the init bundle in the ACS Portal see the appendix.</p>
<p>Let&rsquo;s create the init bundle using the ACS <strong>API</strong> on the commandline:</p>
<p>Go to your Web Terminal (if it timed out just start it again), then paste, edit and execute the following lines:</p>
<ul>
<li>Set the ACS API endpoint, replace <code>&lt;central_url&gt;</code> with the URL of your ACS portal (without &lsquo;https://&rsquo; e.g. central-stackrox.apps.cluster-cqtsh.cqtsh.example.com )</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">export ROX_ENDPOINT<span style="color:#f92672">=</span>&lt;central_url&gt;:443
</code></pre></div><ul>
<li>Set the admin password (same as for the portal, look up the secrets again)</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">export PASSWORD<span style="color:#f92672">=</span>&lt;password&gt;
</code></pre></div><ul>
<li>Give the init bundle a name</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">export DATA<span style="color:#f92672">={</span><span style="color:#ae81ff">\&#34;</span>name<span style="color:#ae81ff">\&#34;</span>:<span style="color:#ae81ff">\&#34;</span>my-init-bundle<span style="color:#ae81ff">\&#34;</span><span style="color:#f92672">}</span>
</code></pre></div><ul>
<li>Finally run the <code>curl</code> command against the API to create the init bundle using the variables set above</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl -k -o bundle.json -X POST -u <span style="color:#e6db74">&#34;admin:</span>$PASSWORD<span style="color:#e6db74">&#34;</span> -H <span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span> --data $DATA https://<span style="color:#e6db74">${</span>ROX_ENDPOINT<span style="color:#e6db74">}</span>/v1/cluster-init/init-bundles
</code></pre></div><ul>
<li>Convert it to the needed format</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat bundle.json | jq -r <span style="color:#e6db74">&#39;.kubectlBundle&#39;</span> &gt; bundle64
base64 -d bundle64 &gt; kube-secrets.bundle
</code></pre></div><p>You should now have these two files in your Web Terminal session: <code>bundle.json</code> and <code>kube-secrets.bundle</code>.</p>
<p>The init bundle needs to be applied to all OpenShift clusters you want to secure and monitor.</p>

<div class="notices info" ><p>As said, you can create an init bundle in the ACS Portal, download it and apply it from any terminal where you can run <code>oc</code> against your cluster. We did it the API way to show you how to do it and to enable you to use the Web Terminal.</p>
</div>

<h3 id="prepare-the-secured-cluster">Prepare the Secured Cluster</h3>
<p>For this workshop we run <strong>Central</strong> and <strong>SecuredCluster</strong> on one OpenShift cluster. E.g. we monitor and secure the same cluster the central services live on.</p>
<p><strong>Apply the init bundle</strong></p>
<p>Again in the web terminal:</p>
<ul>
<li>Run <code>oc create -f kube-secrets.bundle -n stackrox</code> pointing to the init bundle you downloaded from the Central instance or created via the API as above.</li>
<li>This will create a number of secrets, the output should be:</li>
</ul>
<pre><code>secret/collector-tls created
secret/sensor-tls created
secret/admission-control-tls created
</code></pre><h3 id="add-the-cluster-as-securedcluster-to-acs-central">Add the Cluster as <strong>SecuredCluster</strong> to <strong>ACS Central</strong></h3>
<p>You are ready to install the <strong>SecuredClusters</strong> instance, this will deploy the secured cluster services:</p>
<ul>
<li>In the <strong>OpenShift Web Console</strong> go to the <strong>ACS Operator</strong> in <strong>Operators-&gt;Installed Operators</strong></li>
<li>Using the Operator create an instance of the <strong>Secured Cluster</strong> type <strong>in the Project you created</strong> (should be stackrox)</li>
<li>Change the <strong>Cluster Name</strong> for the cluster if you want, it&rsquo;ll appear under this name in the <strong>ACS Portal</strong></li>
<li>And most importantly for <strong>Central Endpoint</strong> enter the address and port number of your <strong>Central</strong> instance, this is the same as the <strong>ACS Portal</strong>.
<ul>
<li>If your <strong>ACS Portal</strong> is available at <code>https://central-stackrox.apps.&lt;DOMAIN&gt;</code> the endpoint is <code>central-stackrox.apps.&lt;DOMAIN&gt;:443</code>.</li>
</ul>
</li>
<li>Under <strong>Admission Control Settings</strong> make sure
<ul>
<li><strong>listenOnCreates</strong>, <strong>listenOnUpdates</strong> and <strong>ListenOnEvents</strong> is enabled</li>
<li>Set <strong>Contact Image Scanners</strong> to <strong>ScanIfMissing</strong></li>
</ul>
</li>
</ul>
<!-- - Under **Per Node Settings** -> **Collector Settings** change the value for **Collection** form `EBPF` to `KernelModule`. This is a workaround for a known issue. -->
<ul>
<li>Click <strong>Create</strong></li>
</ul>
<p>Now go to your <strong>ACS Portal</strong> again, after a couple of minutes you should see your secured cluster under <strong>Platform Configuration-&gt;Clusters</strong>. Wait until all <strong>Cluster Status</strong> indicators become green.</p>
<h2 id="configure-quay-integrations-in-acs">Configure Quay Integrations in ACS</h2>
<h3 id="create-an-integration-to-scan-the-quay-registry">Create an integration to scan the Quay registry</h3>
<p>To enable scanning of images in your Quay registry, you&rsquo;ll have to configure an <strong>Integration</strong> with valid credentials, so this is what you&rsquo;ll do.</p>
<p>Now create a new Integration:</p>
<ul>
<li>Access the <strong>RHACS Portal</strong> and configure the already existing integrations of type <strong>Generic Docker Registry</strong>.</li>
<li>Go to <strong>Platform Configuration -&gt; Integrations -&gt; Generic Docker Registry</strong>.</li>
<li>Click the <strong>New integration</strong> button</li>
<li><strong>Integration name</strong>: Quay local</li>
<li><strong>Endpoint</strong>: <code>https://quay-quay-quay.apps.&lt;DOMAIN&gt;</code> (replace domain if required)</li>
<li><strong>Username</strong>: quayadmin</li>
<li><strong>Password</strong>: quayadmin</li>
<li>Press the <strong>Test</strong> button to validate the connection and press <strong>Save</strong> when the test is successful.</li>
</ul>
<h2 id="architecture-recap">Architecture recap</h2>
<figure>
    <img src="../images/workshop_architecture_stackrox.png?width=50pc&amp;classes=border,shadow"/> <figcaption>
            <h4>Click image to enlarge</h4>
        </figcaption>
</figure>






<footer class=" footline" >
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="https://devsecops-workshop.github.io/5-gitops/" title="Configure GitOps"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="https://devsecops-workshop.github.io/11-rhacs-warmup/" title="Getting to know ACS" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="https://devsecops-workshop.github.io/js/clipboard.min.js?1712675336"></script>
    <script src="https://devsecops-workshop.github.io/js/perfect-scrollbar.min.js?1712675336"></script>
    <script src="https://devsecops-workshop.github.io/js/perfect-scrollbar.jquery.min.js?1712675336"></script>
    <script src="https://devsecops-workshop.github.io/js/jquery.sticky.js?1712675336"></script>
    <script src="https://devsecops-workshop.github.io/js/featherlight.min.js?1712675336"></script>
    <script src="https://devsecops-workshop.github.io/js/highlight.pack.js?1712675336"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="https://devsecops-workshop.github.io/js/modernizr.custom-3.6.0.js?1712675336"></script>
    <script src="https://devsecops-workshop.github.io/js/learn.js?1712675336"></script>
    <script src="https://devsecops-workshop.github.io/js/hugo-learn.js?1712675336"></script>
    
        
            <script src="https://devsecops-workshop.github.io/mermaid/mermaid.js?1712675336"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>
